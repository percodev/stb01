# Обновление встроенного ПО
Файл прошивки передаётся в контроллер следующими кадрами. В первом кадре `from` д.б. равно `0`.
В последнем `to` д.б. равно `size`.

## Загрузка
```json
{
        "set" : "binary",
        "binary" : {
		"file" : "firmware",
		"size" : 5757200,
		"from" : 0,
		"to" : 511,
		"part" : "IyBNYWluIGZpbGUgZm9yIE5YUCBMUEMxeHh4L0xQQzQweHggc2VyaWVzIENvcnRleC1NMC8wKy8zLzRGIHBhcnRzCiMKIyAhISEhISEKIwojIFRoaXMgZmlsZSBzaG91bGQgbm90IGJlIGluY2x1ZGVkIGRpcmVjdGx5LCByYXRoZXIgYnkgdGhlIGxwYzExeHguY2ZnLAojIGxwYzEzeHguY2ZnLCBscGMxN3h4LmNmZywgZXRjLiB3aGljaCBzZXQgdGhlIG5lZWRlZCB2YXJpYWJsZXMgdG8gdGhlCiMgYXBwcm9wcmlhdGUgdmFsdWVzLgojCiMgISEhISEhCgojIExQQzh4eCBjaGlwcyBzdXBwb3J0IG9ubHkgU1dEIHRyYW5zcG9ydC4KIyBMUEMxMXh4IGNoaXBzIHN1cHBvcnQgb25seSBTV0QgdHJhbnNwb3J0LgojIExQQzEyeHggY2hpcHMgc3VwcG9ydCBvbmx5IFNXRCB0cmFuc3BvcnQuCiMgTFBDMTFVeHggY2hpcHMgc3VwcG9ydCBvbmx5IFNXRCB0cmFuc3BvcnRzLgojIExQQzEzeHggY2hpcHMgc3VwcG9ydCBvbmx5IFNXRCB0cmFuc3BvcnRzLgojIExQQzE3eHggY2hpcHMgc3VwcG9ydCBib3RoIEpUQQ"
	}
}
```
## Ответ (результат выполнения set)
```json
{
	"answer" : { "binary": "ok" },
	"binary" : {
		"file" : "firmware",
		"size" : 5757200,
		"from" : 0,
		"to" : 511,
		"part" : "IyBNYWluIGZpbGUgZm9yIE5YUCBMUEMxeHh4L0xQQzQweHggc2VyaWVzIENvcnRleC1NMC8wKy8zLzRGIHBhcnRzCiMKIyAhISEhISEKIwojIFRoaXMgZmlsZSBzaG91bGQgbm90IGJlIGluY2x1ZGVkIGRpcmVjdGx5LCByYXRoZXIgYnkgdGhlIGxwYzExeHguY2ZnLAojIGxwYzEzeHguY2ZnLCBscGMxN3h4LmNmZywgZXRjLiB3aGljaCBzZXQgdGhlIG5lZWRlZCB2YXJpYWJsZXMgdG8gdGhlCiMgYXBwcm9wcmlhdGUgdmFsdWVzLgojCiMgISEhISEhCgojIExQQzh4eCBjaGlwcyBzdXBwb3J0IG9ubHkgU1dEIHRyYW5zcG9ydC4KIyBMUEMxMXh4IGNoaXBzIHN1cHBvcnQgb25seSBTV0QgdHJhbnNwb3J0LgojIExQQzEyeHggY2hpcHMgc3VwcG9ydCBvbmx5IFNXRCB0cmFuc3BvcnQuCiMgTFBDMTFVeHggY2hpcHMgc3VwcG9ydCBvbmx5IFNXRCB0cmFuc3BvcnRzLgojIExQQzEzeHggY2hpcHMgc3VwcG9ydCBvbmx5IFNXRCB0cmFuc3BvcnRzLgojIExQQzE3eHggY2hpcHMgc3VwcG9ydCBib3RoIEpUQQ"
	}
}
```
 После ответа на последний кадр загрузки необходимо перезагрузить контроллер командой:

## Команда
```json
{
        "control" : "reboot",
        "reboot" : {}
}
```

## Ответ (результат выполнения control)
```json
{
	"result" : { "reboot": "ok" },
	"reboot" : {}
}
```

После передачи ответа контроллер перезагрузится, и начнётся процесс перепрошивки. Процесс перепрошивки может занимать длительное время (типично - несколько минут), в течение его контроллер может несколько раз перезагружаться. После перепрошивки восстановится связь с софтом (WEB UI).

# Обновление HTTPS сертификата
Сертификат передаётся в контроллер аналогично прошивке. Перезагрузка не требуется.
# Логирование
# Резервирование БД


`file` — Тип загружаемого файла:

	`firmware`  — прошивка
	`ssl`  — HTTPS сертификат

`size` — Размер файла.

`from` — Позиция в файле 1-го байта передаваемых данных.

`to` — Позиция в файле последнего байта передаваемых данных.

`part` — Передаваемые данные (часть файла от `from` до `to`), строка в base64. 

Загружаемый файл представляет собой бинарные данные (в общем случае). Каждая часть файла перед передачей кодируется в base64, и помещается в поле `part`. Поля `size`, `from` и `to` относятся к бинарным данным (не стооке)! Т.е. размер передаваемых в кадре бинарных данных `to` - `from` будет на 1/4 меньше размера строки `part`.